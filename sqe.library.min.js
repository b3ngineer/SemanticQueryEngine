function SemanticQueryEngine(){function a(){this._terms=[];this._terms[0]=[];this._rules=[];this._eventHandler=this._conflictStrategy=null}var p={equal:0,greaterThanOrEqual:1,greaterThan:2,lessThanOrEqual:-1,lessThan:-2};a.prototype._name="SearchModel";a.prototype._numberExists=function(c){for(var b=this._terms[0].length,a=0,d=b-1,b=Math.floor(b/2);d>=a;){var g=this._terms[0][b];if(c===g)return!0;c<g?d=b-1:a=b+1;b=Math.floor((a+d)/2)}return!1};a.prototype.addTerm=function(c){if("number"===typeof c)this._numberExists(c)||
(this._terms[0].push(c),this._terms[0].sort());else{var b=c.toString();c=b.length;if("undefined"===typeof this._terms[c])this._terms[c]=b;else if(!(-1<this._terms[c].indexOf(b))){for(var a=this._terms[c].length/c,b=[b],d=0;d<a;d++)b.push(this._terms[c].substring(d*c,d*c+c));b.sort();this._terms[c]=b.join("")}}};a.prototype.addRules=function(c){if("undefined"===typeof c)throw Error("The specified rules parameter is undefined (calling addRules)");for(var b=0,a=c.length;b<a;b++)for(var d=0,g=c[b].terms.length;d<
g;d++){var f=c[b].terms[d];this.addTerm(f)}b=0;for(a=c.length;b<a;b++){var e=[],g=c[b].terms.length,m=0,h=c[b].action,k={terms:c[b].terms,index:b};"undefined"===typeof h&&"undefined"!==typeof c[b].event&&(h=this._eventHandler);k.event=c[b].event||{};for(d=0;d<g;d++){var f=c[b].terms[d],n=this.getTermId(f),f=n[0],q=n[1];f>m&&(m=f);"undefined"===typeof e[f]&&(e[f]=[]);e[f][q]=n;"undefined"!==typeof c[b].operators&&"undefined"!=typeof c[b].operators[d]?(n=p[c[b].operators[d].toString()],e[f][q][2]="undefined"!==
typeof n?n:c[b].operators[d]):e[f][q][2]=0}e[m+1]=g;if(h)e[m+2]=function(b,c){var a=function(){b.apply(a,null)};a.terms=c.terms;a.index=c.index;a.event=c.event;return a}(h,k);else throw Error("All rules require either 'action' or 'event' to be defined (if 'event' is defined, an eventHandler must also be defined, either in the model.eventHandler or by calling addEventHandler); failing at rule index "+b);this._rules.push(e)}};a.prototype.getNumberId=function(c){for(var b=this._terms[0].length,a=0,d=
b-1,b=Math.floor(b/2);d>=a;){var g=this._terms[0][b];if(c===g)return[0,b];c<g?d=b-1:a=b+1;b=Math.floor((a+d)/2)}return!1};a.prototype.getTermId=function(c){if("number"===typeof c)return this.getNumberId(c);c=c.toString();var b=c.length;if(!this._terms[b])return!1;for(var a=this._terms[b].length/b,d=0,g=a-1,a=Math.floor(a/2);g>=d;){var f=b*a,e=this._terms[b].substr(f,b);if(c===e)return[b,f/b];c<e?g=a-1:d=a+1;a=Math.floor((d+g)/2)}return!1};a.prototype.isEqualTermId=function(a,b){if(!a||!b||a.length!==
b.length)return!1;for(var l=0;l<a.length;l++)if(a[l]!==b[l])return!1;return!0};a.prototype.executeQuery=function(a){if("undefined"===typeof a)throw Error("Cannot execute query on undefined state");for(var b=[],l=[],d=0,g=a.length;d<g;d++)for(var f=this.getTermId(a[d]),e=0,m=this._rules.length;e<m;e++){"undefined"===typeof b[e]&&(b[e]=0);var h=this._rules[e].length,k=this._rules[e][h-2];b[e]!=k&&(h=f[1],k=this._rules[e][f[0]],"undefined"===typeof k||("undefined"===typeof k[h]||!(k[h]instanceof Array))||
b[e]++)}d=0;for(a=b.length;d<a;d++)h=this._rules[d].length,k=this._rules[d][h-2],b[d]===k&&l.push(this._rules[d][h-1]);"function"===typeof this._conflictStrategy&&this._conflictStrategy.apply(l,null);return l};this._searchModel=new a}SemanticQueryEngine.prototype._name="SemanticQueryEngine";
SemanticQueryEngine.prototype.addDataModel=function(a){a instanceof Array?this._searchModel.addRules(a):(this._searchModel._conflictStrategy=a.conflictStrategy||this._searchModel._conflictStrategy,this._searchModel._eventHandler=a.eventHandler||this._searchModel._eventHandler,"undefined"!==typeof a._terms&&0<a._terms.length&&"undefined"!==typeof a._rules&&0<a._rules.length?(this._searchModel._terms=a._terms,this._searchModel._rules=a._rules):this._searchModel.addRules(a.rules))};
SemanticQueryEngine.prototype.addConflictStrategy=function(a){this._searchModel._conflictStrategy=a};SemanticQueryEngine.prototype.isEqualTermId=function(a,p){return this._searchModel.isEqualTermId(a,p)};SemanticQueryEngine.prototype.getNumberId=function(a){return this._searchModel.getNumberId(a)};SemanticQueryEngine.prototype.getTermId=function(a){return this._searchModel.getTermId(a)};SemanticQueryEngine.prototype.executeQuery=function(a){return this._searchModel.executeQuery(a)};
SemanticQueryEngine.prototype.addEventHandler=function(a){this._searchModel._eventHandler=a};
